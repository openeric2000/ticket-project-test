<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÈÅ∏ÊìáÂ∫ß‰Ωç - Tixcraft</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft JhengHei", sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            text-decoration: none;
            color: white;
        }

        .timer {
            background: rgba(255,255,255,0.2);
            padding: 0.5rem 1rem;
            border-radius: 5px;
            font-size: 1.1rem;
        }

        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 20px;
            margin: 20px auto;
            max-width: 1400px;
            padding: 0 20px;
        }

        /* Left Panel - Seat Map */
        .seat-map-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .event-info {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .event-info h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .event-meta {
            display: flex;
            gap: 20px;
            color: #666;
            font-size: 0.95rem;
        }

        .event-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Stage */
        .stage {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 15px;
            margin: 20px auto 30px;
            border-radius: 10px 10px 50% 50%;
            font-weight: bold;
            font-size: 1.1rem;
            max-width: 80%;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        /* Zoom Controls */
        .zoom-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .zoom-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .zoom-btn:hover {
            background: #5568d3;
            transform: scale(1.05);
        }

        /* Seat Map Wrapper */
        .seat-map-wrapper {
            overflow: auto;
            max-height: 600px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            background: #fafafa;
        }

        .seat-map {
            display: inline-block;
            transition: transform 0.3s;
            transform-origin: center;
        }

        /* Zone Section */
        .zone-section {
            margin-bottom: 30px;
        }

        .zone-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .zone-price {
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 0.9rem;
        }

        /* Seat Rows */
        .seat-row {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 8px;
            gap: 5px;
        }

        .row-label {
            min-width: 40px;
            text-align: right;
            font-weight: bold;
            color: #667eea;
            font-size: 0.9rem;
        }

        .seats {
            display: flex;
            gap: 5px;
        }

        /* Seat Styles */
        .seat {
            width: 32px;
            height: 32px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 500;
            transition: all 0.2s;
            position: relative;
        }

        .seat:hover:not(.sold):not(.reserved) {
            transform: scale(1.15);
            z-index: 10;
        }

        .seat.available {
            background: #4CAF50;
            color: white;
            border: 2px solid #45a049;
        }

        .seat.available:hover {
            background: #45a049;
            box-shadow: 0 4px 10px rgba(76, 175, 80, 0.5);
        }

        .seat.selected {
            background: #667eea;
            color: white;
            border: 2px solid #5568d3;
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.5);
            transform: scale(1.1);
        }

        .seat.sold {
            background: #e0e0e0;
            color: #999;
            cursor: not-allowed;
            border: 2px solid #d0d0d0;
        }

        .seat.reserved {
            background: #ff9800;
            color: white;
            cursor: not-allowed;
            border: 2px solid #f57c00;
        }

        .seat-gap {
            width: 32px;
            height: 32px;
        }

        /* Legend */
        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .legend-seat {
            width: 24px;
            height: 24px;
            border-radius: 4px;
        }

        /* Right Panel - Order Summary */
        .order-summary {
            position: sticky;
            top: 20px;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            height: fit-content;
        }

        .order-summary h2 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #667eea;
        }

        .selected-seats-list {
            margin-bottom: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .selected-seat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 5px;
            margin-bottom: 8px;
            border-left: 4px solid #667eea;
        }

        .seat-info {
            flex: 1;
        }

        .seat-zone {
            font-weight: bold;
            color: #333;
            font-size: 0.95rem;
        }

        .seat-number {
            color: #666;
            font-size: 0.85rem;
            margin-top: 2px;
        }

        .seat-price {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1rem;
        }

        .remove-seat {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: background 0.3s;
        }

        .remove-seat:hover {
            background: #ee5a52;
        }

        .empty-selection {
            text-align: center;
            padding: 40px 20px;
            color: #999;
        }

        .empty-selection-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .order-total {
            border-top: 2px solid #e0e0e0;
            padding-top: 15px;
            margin-bottom: 20px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .total-row.final {
            font-size: 1.3rem;
            font-weight: bold;
            color: #667eea;
            padding-top: 10px;
            border-top: 1px solid #e0e0e0;
        }

        .checkout-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .checkout-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .checkout-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .max-seats-warning {
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            border-left: 4px solid #ffc107;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .order-summary {
                position: static;
            }

            .seat {
                width: 28px;
                height: 28px;
                font-size: 0.65rem;
            }
        }

        @media (max-width: 768px) {
            .seat {
                width: 24px;
                height: 24px;
                font-size: 0.6rem;
            }

            .seat-gap {
                width: 24px;
                height: 24px;
            }

            .row-label {
                min-width: 30px;
                font-size: 0.8rem;
            }

            .event-info h1 {
                font-size: 1.3rem;
            }

            .event-meta {
                flex-direction: column;
                gap: 8px;
            }
        }

        /* Loading Animation */
        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Tooltip */
        .seat-tooltip {
            position: absolute;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            white-space: nowrap;
            pointer-events: none;
            z-index: 1000;
            display: none;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">üé´ Tixcraft</a>
                <div class="timer">
                    ‚è±Ô∏è Ââ©È§òÊôÇÈñì: <span id="countdown">10:00</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Left Panel - Seat Map -->
        <div class="seat-map-container">
            <div class="event-info">
                <h1>2025 Ë∑®Âπ¥ÊºîÂî±ÊúÉ</h1>
                <div class="event-meta">
                    <span>üìÖ 2025/12/31 (‰∏â) 20:00</span>
                    <span>üìç Âè∞ÂåóÂ∞èÂ∑®Ëõã</span>
                    <span>üé§ Â§ö‰ΩçËóù‰∫∫</span>
                </div>
            </div>

            <!-- Stage -->
            <div class="stage">üé≠ ËàûÂè∞ STAGE üé≠</div>

            <!-- Zoom Controls -->
            <div class="zoom-controls">
                <button class="zoom-btn" onclick="zoomOut()">‚ûñ Á∏ÆÂ∞è</button>
                <button class="zoom-btn" onclick="resetZoom()">üîÑ ÈáçË®≠</button>
                <button class="zoom-btn" onclick="zoomIn()">‚ûï ÊîæÂ§ß</button>
            </div>

            <!-- Seat Map -->
            <div class="seat-map-wrapper">
                <div class="seat-map" id="seatMap">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>ËºâÂÖ•Â∫ß‰ΩçÂúñ‰∏≠...</p>
                    </div>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-seat available"></div>
                    <span>ÂèØÈÅ∏Êìá</span>
                </div>
                <div class="legend-item">
                    <div class="legend-seat selected"></div>
                    <span>Â∑≤ÈÅ∏Êìá</span>
                </div>
                <div class="legend-item">
                    <div class="legend-seat reserved"></div>
                    <span>‰øùÁïô‰∏≠</span>
                </div>
                <div class="legend-item">
                    <div class="legend-seat sold"></div>
                    <span>Â∑≤ÂîÆÂá∫</span>
                </div>
            </div>
        </div>

        <!-- Right Panel - Order Summary -->
        <div class="order-summary">
            <h2>üìã Ë®ÇÂñÆÊëòË¶Å</h2>
            
            <div id="maxSeatsWarning" class="max-seats-warning" style="display: none;">
                ‚ö†Ô∏è ÊØèÁ≠ÜË®ÇÂñÆÊúÄÂ§öÈÅ∏Êìá 6 ÂÄãÂ∫ß‰Ωç
            </div>

            <div class="selected-seats-list" id="selectedSeatsList">
                <div class="empty-selection">
                    <div class="empty-selection-icon">üí∫</div>
                    <p>Ë´ãÂæûÂ∫ß‰ΩçÂúñ‰∏≠ÈÅ∏ÊìáÂ∫ß‰Ωç</p>
                </div>
            </div>

            <div class="order-total">
                <div class="total-row">
                    <span>Â∫ß‰ΩçÊï∏Èáè:</span>
                    <span id="seatCount">0</span>
                </div>
                <div class="total-row">
                    <span>Â∞èË®à:</span>
                    <span id="subtotal">NT$ 0</span>
                </div>
                <div class="total-row">
                    <span>ÊúçÂãôË≤ª:</span>
                    <span id="serviceFee">NT$ 0</span>
                </div>
                <div class="total-row final">
                    <span>Á∏ΩË®à:</span>
                    <span id="total">NT$ 0</span>
                </div>
            </div>

            <button class="checkout-btn" id="checkoutBtn" disabled onclick="checkout()">
                ÂâçÂæÄÁµêÂ∏≥
            </button>
        </div>
    </div>

    <!-- Tooltip -->
    <div class="seat-tooltip" id="seatTooltip"></div>

    <script>
        // Global variables
        let selectedSeats = [];
        const MAX_SEATS = 6;
        const SERVICE_FEE_RATE = 0.1; // 10% service fee
        let zoomLevel = 1;
        let countdownTimer;
        let timeRemaining = 600; // 10 minutes in seconds

        // Seat data structure
        const seatData = {
            zones: [
                {
                    name: 'VIP ÁâπÂçÄ',
                    price: 3800,
                    rows: [
                        { label: 'A', seats: [1, 2, 3, 4, 'gap', 5, 6, 7, 8, 9, 10, 'gap', 11, 12, 13, 14] },
                        { label: 'B', seats: [1, 2, 3, 4, 'gap', 5, 6, 7, 8, 9, 10, 'gap', 11, 12, 13, 14] },
                        { label: 'C', seats: [1, 2, 3, 4, 'gap', 5, 6, 7, 8, 9, 10, 'gap', 11, 12, 13, 14] },
                        { label: 'D', seats: [1, 2, 3, 4, 'gap', 5, 6, 7, 8, 9, 10, 'gap', 11, 12, 13, 14] },
                    ]
                },
                {
                    name: 'A ÂçÄÊêñÊªæÂçÄ',
                    price: 2800,
                    rows: [
                        { label: 'E', seats: [1, 2, 3, 4, 5, 6, 'gap', 7, 8, 9, 10, 11, 12, 'gap', 13, 14, 15, 16, 17, 18] },
                        { label: 'F', seats: [1, 2, 3, 4, 5, 6, 'gap', 7, 8, 9, 10, 11, 12, 'gap', 13, 14, 15, 16, 17, 18] },
                        { label: 'G', seats: [1, 2, 3, 4, 5, 6, 'gap', 7, 8, 9, 10, 11, 12, 'gap', 13, 14, 15, 16, 17, 18] },
                        { label: 'H', seats: [1, 2, 3, 4, 5, 6, 'gap', 7, 8, 9, 10, 11, 12, 'gap', 13, 14, 15, 16, 17, 18] },
                        { label: 'I', seats: [1, 2, 3, 4, 5, 6, 'gap', 7, 8, 9, 10, 11, 12, 'gap', 13, 14, 15, 16, 17, 18] },
                        { label: 'J', seats: [1, 2, 3, 4, 5, 6, 'gap', 7, 8, 9, 10, 11, 12, 'gap', 13, 14, 15, 16, 17, 18] },
                    ]
                },
                {
                    name: 'B ÂçÄ‰∏ÄËà¨Â∫ß‰Ωç',
                    price: 1800,
                    rows: [
                        { label: 'K', seats: [1, 2, 3, 4, 5, 6, 7, 8, 'gap', 9, 10, 11, 12, 13, 14, 15, 16, 'gap', 17, 18, 19, 20, 21, 22, 23, 24] },
                        { label: 'L', seats: [1, 2, 3, 4, 5, 6, 7, 8, 'gap', 9, 10, 11, 12, 13, 14, 15, 16, 'gap', 17, 18, 19, 20, 21, 22, 23, 24] },
                        { label: 'M', seats: [1, 2, 3, 4, 5, 6, 7, 8, 'gap', 9, 10, 11, 12, 13, 14, 15, 16, 'gap', 17, 18, 19, 20, 21, 22, 23, 24] },
                        { label: 'N', seats: [1, 2, 3, 4, 5, 6, 7, 8, 'gap', 9, 10, 11, 12, 13, 14, 15, 16, 'gap', 17, 18, 19, 20, 21, 22, 23, 24] },
                        { label: 'O', seats: [1, 2, 3, 4, 5, 6, 7, 8, 'gap', 9, 10, 11, 12, 13, 14, 15, 16, 'gap', 17, 18, 19, 20, 21, 22, 23, 24] },
                        { label: 'P', seats: [1, 2, 3, 4, 5, 6, 7, 8, 'gap', 9, 10, 11, 12, 13, 14, 15, 16, 'gap', 17, 18, 19, 20, 21, 22, 23, 24] },
                        { label: 'Q', seats: [1, 2, 3, 4, 5, 6, 7, 8, 'gap', 9, 10, 11, 12, 13, 14, 15, 16, 'gap', 17, 18, 19, 20, 21, 22, 23, 24] },
                        { label: 'R', seats: [1, 2, 3, 4, 5, 6, 7, 8, 'gap', 9, 10, 11, 12, 13, 14, 15, 16, 'gap', 17, 18, 19, 20, 21, 22, 23, 24] },
                    ]
                }
            ]
        };

        // Generate random seat status
        function getRandomStatus() {
            const rand = Math.random();
            if (rand < 0.7) return 'available'; // 70% available
            if (rand < 0.85) return 'sold'; // 15% sold
            return 'reserved'; // 15% reserved
        }

        // Initialize seat map
        function initSeatMap() {
            const seatMapEl = document.getElementById('seatMap');
            seatMapEl.innerHTML = '';

            seatData.zones.forEach((zone, zoneIndex) => {
                const zoneSection = document.createElement('div');
                zoneSection.className = 'zone-section';

                const zoneHeader = document.createElement('div');
                zoneHeader.className = 'zone-header';
                zoneHeader.innerHTML = `
                    <span>${zone.name}</span>
                    <span class="zone-price">NT$ ${zone.price.toLocaleString()}</span>
                `;
                zoneSection.appendChild(zoneHeader);

                zone.rows.forEach(row => {
                    const rowDiv = document.createElement('div');
                    rowDiv.className = 'seat-row';

                    const rowLabel = document.createElement('div');
                    rowLabel.className = 'row-label';
                    rowLabel.textContent = row.label;
                    rowDiv.appendChild(rowLabel);

                    const seatsDiv = document.createElement('div');
                    seatsDiv.className = 'seats';

                    row.seats.forEach(seat => {
                        if (seat === 'gap') {
                            const gap = document.createElement('div');
                            gap.className = 'seat-gap';
                            seatsDiv.appendChild(gap);
                        } else {
                            const seatEl = document.createElement('div');
                            const status = getRandomStatus();
                            seatEl.className = `seat ${status}`;
                            seatEl.dataset.zone = zone.name;
                            seatEl.dataset.row = row.label;
                            seatEl.dataset.seat = seat;
                            seatEl.dataset.price = zone.price;
                            seatEl.dataset.status = status;
                            seatEl.textContent = seat;

                            if (status === 'available') {
                                seatEl.onclick = () => toggleSeat(seatEl);
                            }

                            // Tooltip
                            seatEl.onmouseenter = (e) => showTooltip(e, seatEl);
                            seatEl.onmouseleave = hideTooltip;

                            seatsDiv.appendChild(seatEl);
                        }
                    });

                    rowDiv.appendChild(seatsDiv);
                    zoneSection.appendChild(rowDiv);
                });

                seatMapEl.appendChild(zoneSection);
            });
        }

        // Toggle seat selection
        function toggleSeat(seatEl) {
            const seatId = `${seatEl.dataset.zone}-${seatEl.dataset.row}-${seatEl.dataset.seat}`;
            
            if (seatEl.classList.contains('selected')) {
                // Deselect
                seatEl.classList.remove('selected');
                seatEl.classList.add('available');
                selectedSeats = selectedSeats.filter(s => s.id !== seatId);
            } else {
                // Select
                if (selectedSeats.length >= MAX_SEATS) {
                    document.getElementById('maxSeatsWarning').style.display = 'block';
                    setTimeout(() => {
                        document.getElementById('maxSeatsWarning').style.display = 'none';
                    }, 3000);
                    return;
                }

                seatEl.classList.remove('available');
                seatEl.classList.add('selected');
                selectedSeats.push({
                    id: seatId,
                    zone: seatEl.dataset.zone,
                    row: seatEl.dataset.row,
                    seat: seatEl.dataset.seat,
                    price: parseInt(seatEl.dataset.price)
                });
            }

            updateOrderSummary();
        }

        // Update order summary
        function updateOrderSummary() {
            const listEl = document.getElementById('selectedSeatsList');
            const checkoutBtn = document.getElementById('checkoutBtn');

            if (selectedSeats.length === 0) {
                listEl.innerHTML = `
                    <div class="empty-selection">
                        <div class="empty-selection-icon">üí∫</div>
                        <p>Ë´ãÂæûÂ∫ß‰ΩçÂúñ‰∏≠ÈÅ∏ÊìáÂ∫ß‰Ωç</p>
                    </div>
                `;
                checkoutBtn.disabled = true;
            } else {
                listEl.innerHTML = selectedSeats.map(seat => `
                    <div class="selected-seat-item">
                        <div class="seat-info">
                            <div class="seat-zone">${seat.zone}</div>
                            <div class="seat-number">${seat.row} Êéí ${seat.seat} Ëôü</div>
                        </div>
                        <div class="seat-price">NT$ ${seat.price.toLocaleString()}</div>
                        <button class="remove-seat" onclick="removeSeat('${seat.id}')">‚úï</button>
                    </div>
                `).join('');
                checkoutBtn.disabled = false;
            }

            // Calculate totals
            const subtotal = selectedSeats.reduce((sum, seat) => sum + seat.price, 0);
            const serviceFee = Math.round(subtotal * SERVICE_FEE_RATE);
            const total = subtotal + serviceFee;

            document.getElementById('seatCount').textContent = selectedSeats.length;
            document.getElementById('subtotal').textContent = `NT$ ${subtotal.toLocaleString()}`;
            document.getElementById('serviceFee').textContent = `NT$ ${serviceFee.toLocaleString()}`;
            document.getElementById('total').textContent = `NT$ ${total.toLocaleString()}`;
        }

        // Remove seat
        function removeSeat(seatId) {
            const seatEl = document.querySelector(`[data-zone="${selectedSeats.find(s => s.id === seatId).zone}"][data-row="${selectedSeats.find(s => s.id === seatId).row}"][data-seat="${selectedSeats.find(s => s.id === seatId).seat}"]`);
            if (seatEl) {
                seatEl.classList.remove('selected');
                seatEl.classList.add('available');
            }
            selectedSeats = selectedSeats.filter(s => s.id !== seatId);
            updateOrderSummary();
        }

        // Tooltip functions
        function showTooltip(e, seatEl) {
            const tooltip = document.getElementById('seatTooltip');
            const status = seatEl.dataset.status;
            let statusText = '';
            
            if (status === 'available') statusText = 'ÂèØÈÅ∏Êìá';
            else if (status === 'selected') statusText = 'Â∑≤ÈÅ∏Êìá';
            else if (status === 'sold') statusText = 'Â∑≤ÂîÆÂá∫';
            else if (status === 'reserved') statusText = '‰øùÁïô‰∏≠';

            tooltip.textContent = `${seatEl.dataset.zone} ${seatEl.dataset.row}Êéí${seatEl.dataset.seat}Ëôü - ${statusText}`;
            tooltip.style.display = 'block';
            tooltip.style.left = e.pageX + 10 + 'px';
            tooltip.style.top = e.pageY - 30 + 'px';
        }

        function hideTooltip() {
            document.getElementById('seatTooltip').style.display = 'none';
        }

        // Zoom functions
        function zoomIn() {
            zoomLevel = Math.min(zoomLevel + 0.2, 2);
            applyZoom();
        }

        function zoomOut() {
            zoomLevel = Math.max(zoomLevel - 0.2, 0.6);
            applyZoom();
        }

        function resetZoom() {
            zoomLevel = 1;
            applyZoom();
        }

        function applyZoom() {
            document.getElementById('seatMap').style.transform = `scale(${zoomLevel})`;
        }

        // Countdown timer
        function startCountdown() {
            countdownTimer = setInterval(() => {
                timeRemaining--;
                
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;
                document.getElementById('countdown').textContent = 
                    `${minutes}:${seconds.toString().padStart(2, '0')}`;

                if (timeRemaining <= 0) {
                    clearInterval(countdownTimer);
                    alert('ÈÅ∏‰ΩçÊôÇÈñìÂ∑≤Âà∞ÊúüÔºåË´ãÈáçÊñ∞ÈÅ∏ÊìáÂ∫ß‰Ωç');
                    window.location.href = 'index.html';
                }

                // Warning at 2 minutes
                if (timeRemaining === 120) {
                    alert('‚ö†Ô∏è ÊèêÈÜíÔºöÂâ©È§ò 2 ÂàÜÈêòÔºÅË´ãÁõ°Âø´ÂÆåÊàêÈÅ∏‰Ωç„ÄÇ');
                }
            }, 1000);
        }

        // Checkout
        function checkout() {
            if (selectedSeats.length === 0) {
                alert('Ë´ãÈÅ∏ÊìáËá≥Â∞ë‰∏ÄÂÄãÂ∫ß‰Ωç');
                return;
            }

            const confirmation = confirm(`Á¢∫Ë™çË≥ºË≤∑ ${selectedSeats.length} ÂÄãÂ∫ß‰ΩçÔºü\nÁ∏ΩÈáëÈ°ç: NT$ ${document.getElementById('total').textContent.replace('NT$ ', '')}`);
            
            if (confirmation) {
                // In real app, this would send data to backend
                alert('Ë®ÇÂñÆÂ∑≤Âª∫Á´ãÔºÅ\n\nÊ≠£Âú®ÂâçÂæÄ‰ªòÊ¨æÈ†ÅÈù¢...');
                // Simulate redirect to payment
                setTimeout(() => {
                    alert('‚úÖ ‰ªòÊ¨æÊàêÂäüÔºÅ\nË®ÇÂñÆÁ∑®Ëôü: TIX' + Date.now() + '\n\nÊÑüË¨ùÊÇ®ÁöÑË≥ºË≤∑ÔºåÈõªÂ≠êÁ•®Âà∏Â∑≤ÁôºÈÄÅÂà∞ÊÇ®ÁöÑ‰ø°ÁÆ±„ÄÇ');
                    window.location.href = 'index.html';
                }, 1000);
            }
        }

        // Initialize on page load
        window.onload = () => {
            initSeatMap();
            startCountdown();
        };

        // Clean up on page unload
        window.onbeforeunload = () => {
            if (countdownTimer) {
                clearInterval(countdownTimer);
            }
        };
    </script>
</body>
</html>